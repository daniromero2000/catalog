function getCart() { $.get("/api/getCart?mode=single", function (t) { var a = ""; const e = new Intl.NumberFormat("es-CO", { style: "currency", currency: "COP", minimumFractionDigits: 0 }); t.cartItems.forEach(t => { a += '<a href="/cart" class="dropdown-item"> <div class="media"> <img src="' + t.cover + '" alt="' + t.slug + '" class="img-size-50 mr-3 img-circle"> <div class="media-body"> <h3 class="dropdown-item-title"> ' + t.name + ' </h3> <p class="text-sm"></p> <p class="text-sm text-muted"><i class="fas fa-dollar-sign"></i> ' + t.price + " x " + t.qty + '</p> </div> </div>  </a> <div class="dropdown-divider"></div>', $("#" + t.id).html(e.format(t.price * t.qty)) }); var i = t.cartItems.length; i > 0 && $("#items").show(), t.subtotal = e.format(t.subtotal), t.tax = e.format(t.tax), t.total = e.format(t.total), a = "" != a ? a += '<a href="/cart" class="dropdown-item"> <div class="media"> <div class="media-body d-flex justify-content-between px-4 py-2"> <p class="text-sm subtotal">Subtotal</p> <p class="text-sm text-muted price">' + t.subtotal + '</p> </div> </div>  </a> <div class="dropdown-divider"></div> <div class="dropdown-item dropdown-footer"> <div class="px-3"> <a href="/cart" class="btn button-reset d-block">Ir al carrito</a> </div> </div>' : '<a href="#" class="dropdown-item dropdown-footer">Tu carrito está vacío </a> <div class="dropdown-item dropdown-footer"> <div class="px-3"> <a href="/cart" class="btn button-reset d-block">Ir al carrito</a> </div> </div>', $("#subtotalCart").html(t.subtotal), $("#taxesCart").html(t.tax), $("#totalCart").html(t.total), $("#cartItems").html(a), $("#total").html(i) }) } function addCart(t, a) { if (t && "1" == a) if (quantity = $('input[name="quantity"]').val(), atribute = $("#productAttribute").val(), 0 != quantity) if ($("#productAttribute").val()) { var e = $("#productAttribute").val(); storeItemSingle(t, quantity, e, 1) } else Swal.fire({ title: "Oops!", text: "Por favor selecciona una talla", icon: "warning", confirmButtonText: "Ok" }); else Swal.fire({ title: "Oops!", text: "Por favor ingresa una cantidad", icon: "warning", confirmButtonText: "Ok" }); if (t && "2" == a) if (quantity = $("#qty_input" + t).val(), 0 != quantity) if ($('input[name="productAttribute"]').val()) { e = $('input[name="productAttribute"]').val(); storeItemSingle(t, quantity, e, 1) } else Swal.fire({ title: "oops!", text: "Por favor selecciona una talla", icon: "warning", confirmButtonText: "Ok" }); else Swal.fire({ title: "oops!", text: "Por favor ingresa una cantidad", icon: "warning", confirmButtonText: "Ok" }) } function storeItemAtribute(t, a, e, i) { $.ajax({ url: "/cart", type: "POST", headers: { "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content") }, data: { product: t, quantity: a, productAttribute: e }, success: function (a) { getCart(), Swal.fire({ title: "Añadido!", text: "Tú artículo ha sido añadido al carrito", icon: "success", confirmButtonText: "Ok" }), 1 == i && ($("#productModal" + t).modal("hide"), $("html, body").animate({ scrollTop: $("#cart").offset().top }, 1e3), $("#cartItems").addClass("show"), $("#cart").addClass("show"), $("#cart .nav-link ").attr("aria-expanded", "true")) } }) } function storeItemSingle(t, a, e, i) { var n = {}; n = e ? { product: t, quantity: a, productAttribute: e } : { product: t, quantity: a }, $.ajax({ url: "/cart", type: "POST", headers: { "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content") }, data: n, success: function (a) { getCart(), Swal.fire({ title: "Añadido!", text: "Tú artículo ha sido añadido al carrito", icon: "success", confirmButtonText: "Ok" }), $('input[name="productAttribute"]').val(""); for (var n = [document.getElementById("sizes" + e)], r = 0; r < n.length; r++) { var l = document.getElementsByClassName("sizes active"); l.length > 0 && (l[0].className = l[0].className.replace(" active", "")), this.className += " active" } 1 == i && ($("#productModal" + t).modal("hide"), $("html, body").animate({ scrollTop: $("#cart").offset().top }, 1e3), $("#cartItems").addClass("show"), $("#cart").addClass("show"), $("#cart .nav-link ").attr("aria-expanded", "true")) } }) } function minus(t) { $("#qty_input" + t).val(parseInt($("#qty_input" + t).val()) - 1), 0 == $("#qty_input" + t).val() && $("#qty_input" + t).val(1), $("#qty_input_real" + t).val(parseInt($("#qty_input_real" + t).val()) - 1), 0 == $("#qty_input_real" + t).val() && $("#qty_input_real" + t).val(1), quantity = $("#qty_input_real" + t).val(), rowId = $("#row" + t).val(), updatedItem(rowId, quantity) } function max(t) { $("#qty_input" + t).val(parseInt($("#qty_input" + t).val()) + 1), $("#qty_input_real" + t).val(parseInt($("#qty_input_real" + t).val()) + 1), quantity = $("#qty_input_real" + t).val(), rowId = $("#row" + t).val(), updatedItem(rowId, quantity) } function updatedItem(t, a) { $.ajax({ url: "/cart/" + t, type: "PUT", headers: { "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content") }, data: { quantity: a }, success: function (t) { getCart() } }) } function res() { $("#qty_input").val(parseInt($("#qty_input").val()) - 1), 0 == $("#qty_input").val() && $("#qty_input").val(1), $("#qty_input_real").val(parseInt($("#qty_input_real").val()) - 1), 0 == $("#qty_input_real").val() && $("#qty_input_real").val(1), quantity = $("#qty_input_real").val(), rowId = $("#row").val() } function sum() { $("#qty_input").val(parseInt($("#qty_input").val()) + 1), $("#qty_input_real").val(parseInt($("#qty_input_real").val()) + 1), quantity = $("#qty_input_real").val(), rowId = $("#row").val() } function resId(t) { $("#qty_input" + t).val(parseInt($("#qty_input" + t).val()) - 1), 0 == $("#qty_input" + t).val() && $("#qty_input" + t).val(1), $("#qty_input_real" + t).val(parseInt($("#qty_input_real" + t).val()) - 1), 0 == $("#qty_input_real" + t).val() && $("#qty_input_real" + t).val(1), quantity = $("#qty_input_real" + t).val(), rowId = $("#row" + t).val() } function sumId(t) { $("#qty_input" + t).val(parseInt($("#qty_input" + t).val()) + 1), $("#qty_input_real" + t).val(parseInt($("#qty_input_real" + t).val()) + 1), quantity = $("#qty_input_real" + t).val(), rowId = $("#row" + t).val() } function addValue(t) { $('input[name="productAttribute"]').val(t), document.getElementById("sizes" + t).addEventListener("click", function () { var t = ""; (t = document.getElementsByClassName("sizes active")).length > 0 && (t[0].className = t[0].className.replace(" active", "")), this.className += " active" }) } $(function () { $('[data-toggle="tooltip"]').tooltip() }), jQuery(document).ready(function (t) { getCart() });